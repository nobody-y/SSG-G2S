Testing Predcls
VAL_ALPHA
1
.3
1
.3
1
.3
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 21:01:41,737 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 21:01:41,738 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.3
    VAL_ALPHA_20: 0.3
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 21:01:41,739 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 21:01:46,610 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
2020-09-13 21:01:51,988 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 21:01:51,989 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 21:01:51,990 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 21:01:51,990 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
2020-09-13 21:01:56,727 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 21:01:59,479 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:01:59,480 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:01:59,481 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:01:59,481 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:01:59,481 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:01:59,481 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:02:00,304 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 21:02:02,011 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:02:02,011 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:02:02,011 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:02:02,012 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:02:02,012 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:02:02,302 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:02:02,302 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:02:02,302 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:02:02,302 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:02:02,303 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:02:02,304 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:02:03,425 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 21:02:05,213 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:02:05,214 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:02:05,214 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:02:05,214 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:02:05,214 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:02:05,717 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:02:05,717 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:02:05,717 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:02:05,717 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:02:05,718 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:02:07,359 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 21:02:08,552 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:02:08,552 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:02:08,552 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:02:08,552 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:02:08,552 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:02:08,756 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:02:08,757 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:02:08,758 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:02:08,758 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:02:08,758 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:02:08,758 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 21:02:13,395 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 21:09:22,615 maskrcnn_benchmark.inference INFO: Total run time: 0:07:09.219132 (0.1716876527786255 s / img per device, on 2 devices)
2020-09-13 21:09:22,615 maskrcnn_benchmark.inference INFO: Model inference time: 0:06:12.946404 (0.14917856178283692 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.61s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=36.74s).
Accumulating evaluation results...
DONE (t=5.40s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 21:12:17,778 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5764;   R @ 50: 0.6294;   R @ 100: 0.6451;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6867; ngR @ 50: 0.8213; ngR @ 100: 0.8896;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0133;  zR @ 50: 0.0378;  zR @ 100: 0.0622;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2238;  mR @ 50: 0.2674;  mR @ 100: 0.2827;  for mode=predcls, type=Mean Recall.
(above:0.1477) (across:0.0556) (against:0.0000) (along:0.3205) (and:0.0645) (at:0.6478) (attached to:0.0106) (behind:0.5054) (belonging to:0.0000) (between:0.0000) (carrying:0.7785) (covered in:0.4167) (covering:0.2068) (eating:0.8571) (flying in:0.0000) (for:0.0833) (from:0.0000) (growing on:0.0667) (hanging from:0.1875) (has:0.7579) (holding:0.5379) (in:0.3733) (in front of:0.3601) (laying on:0.0952) (looking at:0.1522) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.4014) (of:0.5617) (on:0.7612) (on back of:0.0455) (over:0.2073) (painted on:0.0000) (parked on:0.4812) (part of:0.0000) (playing:0.0000) (riding:0.8884) (says:0.0000) (sitting on:0.4266) (standing on:0.2717) (to:0.2778) (under:0.3112) (using:0.3077) (walking in:0.0000) (walking on:0.8797) (watching:0.5294) (wearing:0.9828) (wears:0.0000) (with:0.1780) 
SGG eval:   A @ 20: 0.6741;   A @ 50: 0.6787;   A @ 100: 0.6787;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
1
.3
2
.6
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 21:12:32,781 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 21:12:32,781 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.3
    VAL_ALPHA_20: 0.6
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 21:12:32,782 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 21:12:36,570 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
2020-09-13 21:12:40,936 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 21:12:40,937 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 21:12:40,940 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 21:12:40,940 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
2020-09-13 21:12:42,941 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 21:12:43,953 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:12:43,954 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:12:44,289 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 21:12:45,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:12:45,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:12:45,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:12:45,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:12:45,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:12:45,342 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:12:45,711 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 21:12:46,543 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:12:46,543 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:12:46,543 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:12:46,544 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:12:46,544 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:12:46,643 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:12:46,643 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:12:46,644 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:12:47,049 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 21:12:47,961 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:12:47,961 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:12:47,961 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:12:47,961 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:12:47,961 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:12:48,065 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:12:48,066 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:12:48,066 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:12:48,066 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:12:48,066 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:12:48,066 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:12:48,066 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 21:12:55,646 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 21:20:32,191 maskrcnn_benchmark.inference INFO: Total run time: 0:07:36.544581 (0.18261783246994018 s / img per device, on 2 devices)
2020-09-13 21:20:32,191 maskrcnn_benchmark.inference INFO: Model inference time: 0:06:32.857384 (0.15714295377731324 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.62s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=39.59s).
Accumulating evaluation results...
DONE (t=5.98s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 21:22:52,187 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5485;   R @ 50: 0.6022;   R @ 100: 0.6182;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6759; ngR @ 50: 0.8132; ngR @ 100: 0.8851;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0178;  zR @ 50: 0.0378;  zR @ 100: 0.0556;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2470;  mR @ 50: 0.2832;  mR @ 100: 0.3001;  for mode=predcls, type=Mean Recall.
(above:0.1902) (across:0.0556) (against:0.0000) (along:0.4103) (and:0.0645) (at:0.7160) (attached to:0.0289) (behind:0.5079) (belonging to:0.0000) (between:0.0000) (carrying:0.7785) (covered in:0.5000) (covering:0.2673) (eating:0.8571) (flying in:0.0000) (for:0.1481) (from:0.0000) (growing on:0.0667) (hanging from:0.2169) (has:0.7309) (holding:0.5290) (in:0.3703) (in front of:0.3693) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3847) (of:0.5664) (on:0.7012) (on back of:0.0455) (over:0.2195) (painted on:0.0000) (parked on:0.6934) (part of:0.0000) (playing:0.0000) (riding:0.9062) (says:0.0000) (sitting on:0.4248) (standing on:0.3022) (to:0.3611) (under:0.3325) (using:0.3077) (walking in:0.0000) (walking on:0.8861) (watching:0.5294) (wearing:0.9723) (wears:0.0088) (with:0.2186) 
SGG eval:   A @ 20: 0.6517;   A @ 50: 0.6561;   A @ 100: 0.6561;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
1
.3
3
.9
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 21:23:00,487 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 21:23:00,488 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.3
    VAL_ALPHA_20: 0.9
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 21:23:00,488 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 21:23:04,298 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
2020-09-13 21:23:08,669 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 21:23:08,669 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 21:23:08,671 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 21:23:08,671 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors fromloading word vectors from ./datasets/vg/glove.6B.200d.pt ./datasets/vg/glove.6B.200d.pt

__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
2020-09-13 21:23:10,581 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 21:23:11,548 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:23:11,549 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:23:12,120 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 21:23:13,095 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:23:13,095 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:23:13,095 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:23:13,095 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:23:13,095 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:23:13,200 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:23:13,768 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 21:23:14,604 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:23:14,604 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:23:14,604 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:23:14,604 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:23:14,604 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:23:14,699 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:23:14,700 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:23:15,100 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 21:23:15,960 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:23:15,960 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:23:15,960 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:23:15,960 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:23:15,960 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:23:16,052 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:23:16,052 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:23:16,052 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:23:16,052 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:23:16,052 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:23:16,053 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 21:23:18,157 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
2020-09-13 21:33:52,768 maskrcnn_benchmark.inference INFO: Total run time: 0:10:34.610503 (0.2538442011833191 s / img per device, on 2 devices)
2020-09-13 21:33:52,768 maskrcnn_benchmark.inference INFO: Model inference time: 0:08:37.556238 (0.20702249536514283 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=2.26s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=175.95s).
Accumulating evaluation results...
DONE (t=35.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 21:42:47,577 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5137;   R @ 50: 0.5672;   R @ 100: 0.5831;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6568; ngR @ 50: 0.8035; ngR @ 100: 0.8787;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0133;  zR @ 50: 0.0333;  zR @ 100: 0.0511;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2606;  mR @ 50: 0.3001;  mR @ 100: 0.3158;  for mode=predcls, type=Mean Recall.
(above:0.2400) (across:0.0556) (against:0.0000) (along:0.4615) (and:0.2204) (at:0.7625) (attached to:0.0840) (behind:0.5006) (belonging to:0.0000) (between:0.0000) (carrying:0.7785) (covered in:0.5000) (covering:0.3571) (eating:0.8571) (flying in:0.0000) (for:0.2778) (from:0.0000) (growing on:0.0667) (hanging from:0.2537) (has:0.6991) (holding:0.5379) (in:0.3726) (in front of:0.3854) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3546) (of:0.5663) (on:0.6281) (on back of:0.0455) (over:0.2439) (painted on:0.0000) (parked on:0.8262) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4270) (standing on:0.3511) (to:0.4167) (under:0.3376) (using:0.3077) (walking in:0.0000) (walking on:0.8877) (watching:0.5294) (wearing:0.9308) (wears:0.0389) (with:0.2313) 
SGG eval:   A @ 20: 0.6215;   A @ 50: 0.6259;   A @ 100: 0.6259;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
2
.6
1
.3
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 21:43:19,888 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 21:43:19,889 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.6
    VAL_ALPHA_20: 0.3
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 21:43:19,891 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 21:43:32,782 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
2020-09-13 21:43:50,735 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 21:43:50,735 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 21:43:50,736 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 21:43:50,736 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
2020-09-13 21:43:55,919 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 21:43:58,778 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:43:58,779 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:43:58,780 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:43:58,780 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:43:58,780 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:43:58,780 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:43:58,780 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:43:58,780 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
2020-09-13 21:44:01,779 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 21:44:03,252 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:44:03,252 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:44:03,252 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:44:03,252 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:44:03,253 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:44:03,846 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:44:03,846 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:44:03,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:44:03,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:44:03,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:44:03,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:44:03,848 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:44:05,172 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 21:44:06,714 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:44:06,714 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:44:06,714 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:44:06,714 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:44:06,715 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:44:06,979 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:44:06,982 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:44:06,983 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:44:06,983 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:44:06,983 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:44:06,983 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 21:44:06,983 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 21:44:06,983 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 21:44:07,761 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 21:44:10,811 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 21:44:10,811 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 21:44:10,811 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 21:44:10,811 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 21:44:10,811 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 21:44:11,492 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 21:44:11,505 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 21:44:11,506 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 21:44:11,506 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 21:44:11,506 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 21:44:11,506 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 21:44:11,506 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 21:44:18,508 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 21:59:00,971 maskrcnn_benchmark.inference INFO: Total run time: 0:14:42.461781 (0.3529847123146057 s / img per device, on 2 devices)
2020-09-13 21:59:00,971 maskrcnn_benchmark.inference INFO: Model inference time: 0:11:16.579872 (0.2706319487571716 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.69s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=43.63s).
Accumulating evaluation results...
DONE (t=6.56s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 22:01:30,785 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5467;   R @ 50: 0.5995;   R @ 100: 0.6156;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6732; ngR @ 50: 0.8118; ngR @ 100: 0.8841;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0178;  zR @ 50: 0.0378;  zR @ 100: 0.0556;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2526;  mR @ 50: 0.2902;  mR @ 100: 0.3070;  for mode=predcls, type=Mean Recall.
(above:0.1709) (across:0.0556) (against:0.0000) (along:0.4231) (and:0.0645) (at:0.7463) (attached to:0.0381) (behind:0.5240) (belonging to:0.0000) (between:0.0000) (carrying:0.7917) (covered in:0.5000) (covering:0.2673) (eating:0.8571) (flying in:0.0000) (for:0.2037) (from:0.0000) (growing on:0.0667) (hanging from:0.2243) (has:0.7384) (holding:0.5245) (in:0.3724) (in front of:0.3869) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3678) (of:0.5989) (on:0.6876) (on back of:0.0455) (over:0.2195) (painted on:0.0000) (parked on:0.8216) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4240) (standing on:0.3076) (to:0.3889) (under:0.3393) (using:0.3077) (walking in:0.0000) (walking on:0.8967) (watching:0.5294) (wearing:0.9753) (wears:0.0088) (with:0.2158) 
SGG eval:   A @ 20: 0.6457;   A @ 50: 0.6499;   A @ 100: 0.6499;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
2
.6
2
.6
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 22:01:44,750 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 22:01:44,750 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.6
    VAL_ALPHA_20: 0.6
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 22:01:44,751 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 22:01:49,942 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
loading word vectors from ./datasets/vg/glove.6B.200d.pt
2020-09-13 22:01:54,881 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 22:01:54,881 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 22:01:54,882 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 22:01:54,882 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
2020-09-13 22:01:57,180 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 22:01:58,319 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:01:58,319 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:01:58,320 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:01:58,820 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 22:01:59,866 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:01:59,866 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:01:59,866 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:01:59,866 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:01:59,866 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:02:00,304 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:02:00,304 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:02:00,305 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:02:00,306 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:02:00,306 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:02:00,306 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:02:00,833 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 22:02:02,160 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:02:02,160 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:02:02,160 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:02:02,161 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:02:02,161 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:02:02,683 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:02:02,683 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:02:02,683 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:02:02,684 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:02:03,641 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
flag_stat:  False
2020-09-13 22:02:04,893 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:02:04,893 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:02:04,893 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:02:04,893 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:02:04,893 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:02:05,142 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:02:05,143 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:02:07,512 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
2020-09-13 22:08:47,478 maskrcnn_benchmark.inference INFO: Total run time: 0:06:39.965045 (0.15998601808547974 s / img per device, on 2 devices)
2020-09-13 22:08:47,478 maskrcnn_benchmark.inference INFO: Model inference time: 0:05:58.151794 (0.1432607174873352 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.65s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=41.37s).
Accumulating evaluation results...
DONE (t=6.26s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 22:11:03,849 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5279;   R @ 50: 0.5810;   R @ 100: 0.5966;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6650; ngR @ 50: 0.8072; ngR @ 100: 0.8820;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0178;  zR @ 50: 0.0378;  zR @ 100: 0.0556;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2579;  mR @ 50: 0.2944;  mR @ 100: 0.3108;  for mode=predcls, type=Mean Recall.
(above:0.2014) (across:0.0556) (against:0.0000) (along:0.4231) (and:0.0968) (at:0.7564) (attached to:0.0656) (behind:0.5146) (belonging to:0.0000) (between:0.0000) (carrying:0.7917) (covered in:0.5000) (covering:0.3286) (eating:0.8571) (flying in:0.0000) (for:0.2037) (from:0.0000) (growing on:0.0667) (hanging from:0.2684) (has:0.7170) (holding:0.5245) (in:0.3725) (in front of:0.3870) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3550) (of:0.5848) (on:0.6514) (on back of:0.0455) (over:0.2317) (painted on:0.0000) (parked on:0.8276) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4235) (standing on:0.3402) (to:0.4167) (under:0.3427) (using:0.3077) (walking in:0.0000) (walking on:0.8923) (watching:0.5294) (wearing:0.9550) (wears:0.0239) (with:0.2222) 
SGG eval:   A @ 20: 0.6327;   A @ 50: 0.6371;   A @ 100: 0.6371;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
2
.6
3
.9
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 22:11:16,861 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 22:11:16,862 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.6
    VAL_ALPHA_20: 0.9
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 22:11:16,863 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 22:11:22,523 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
2020-09-13 22:11:27,169 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 22:11:27,169 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 22:11:27,171 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 22:11:27,171 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
2020-09-13 22:11:29,381 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:11:30,346 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:11:30,706 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 22:11:31,669 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:11:31,669 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:11:31,669 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:11:31,669 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:11:31,669 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:11:31,771 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:11:31,771 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:11:31,771 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:11:31,772 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:11:32,168 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 22:11:33,111 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:11:33,111 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:11:33,111 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:11:33,111 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:11:33,111 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:33,213 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:11:33,214 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:11:33,214 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:11:33,214 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:11:33,214 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:11:33,214 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:11:33,668 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 22:11:34,548 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:11:34,548 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:11:34,548 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:11:34,548 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:11:34,548 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:11:34,647 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:11:34,648 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:11:36,643 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:18:53,277 maskrcnn_benchmark.inference INFO: Total run time: 0:07:16.634045 (0.17465361795425416 s / img per device, on 2 devices)
2020-09-13 22:18:53,278 maskrcnn_benchmark.inference INFO: Model inference time: 0:06:23.224097 (0.1532896388053894 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.64s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=42.29s).
Accumulating evaluation results...
DONE (t=6.49s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 22:21:17,596 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5091;   R @ 50: 0.5627;   R @ 100: 0.5786;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6520; ngR @ 50: 0.8008; ngR @ 100: 0.8772;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0133;  zR @ 50: 0.0333;  zR @ 100: 0.0511;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2612;  mR @ 50: 0.3025;  mR @ 100: 0.3188;  for mode=predcls, type=Mean Recall.
(above:0.2581) (across:0.0556) (against:0.0000) (along:0.4615) (and:0.2204) (at:0.7625) (attached to:0.0840) (behind:0.4981) (belonging to:0.0143) (between:0.0000) (carrying:0.7982) (covered in:0.5714) (covering:0.3857) (eating:0.8571) (flying in:0.0000) (for:0.2778) (from:0.0000) (growing on:0.0667) (hanging from:0.2537) (has:0.6906) (holding:0.5334) (in:0.3713) (in front of:0.3885) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3474) (of:0.5641) (on:0.6198) (on back of:0.0455) (over:0.2439) (painted on:0.0000) (parked on:0.8404) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4270) (standing on:0.3620) (to:0.4167) (under:0.3376) (using:0.3077) (walking in:0.0000) (walking on:0.8877) (watching:0.5294) (wearing:0.9282) (wears:0.0389) (with:0.2350) 
SGG eval:   A @ 20: 0.6174;   A @ 50: 0.6218;   A @ 100: 0.6218;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
3
.9
1
.3
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 22:21:31,443 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 22:21:31,444 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.9
    VAL_ALPHA_20: 0.3
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 22:21:31,445 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 22:21:36,811 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
loading word vectors from ./datasets/vg/glove.6B.200d.pt
2020-09-13 22:21:41,632 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 22:21:41,632 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 22:21:41,634 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 22:21:41,634 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
2020-09-13 22:21:43,803 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:21:44,820 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:21:45,247 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 22:21:46,314 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:21:46,314 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:21:46,314 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:21:46,314 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:21:46,314 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:21:46,431 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:21:46,432 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:21:47,831 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 22:21:48,923 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:21:48,923 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:21:48,923 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:21:48,923 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:21:48,923 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:21:49,044 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
flag_stat:  False
2020-09-13 22:21:50,061 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 22:21:51,015 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:21:51,016 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:21:51,016 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:21:51,016 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:21:51,016 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:21:51,125 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:21:51,125 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:21:51,125 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:21:51,125 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:21:51,125 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:21:51,126 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:21:53,246 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
2020-09-13 22:29:59,554 maskrcnn_benchmark.inference INFO: Total run time: 0:08:06.307761 (0.19452310447692872 s / img per device, on 2 devices)
2020-09-13 22:29:59,555 maskrcnn_benchmark.inference INFO: Model inference time: 0:07:01.340286 (0.16853611459732057 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.66s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=41.75s).
Accumulating evaluation results...
DONE (t=6.53s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 22:32:42,645 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5067;   R @ 50: 0.5591;   R @ 100: 0.5750;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6503; ngR @ 50: 0.7994; ngR @ 100: 0.8771;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0178;  zR @ 50: 0.0378;  zR @ 100: 0.0556;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2661;  mR @ 50: 0.3026;  mR @ 100: 0.3201;  for mode=predcls, type=Mean Recall.
(above:0.2110) (across:0.0556) (against:0.0000) (along:0.4615) (and:0.1075) (at:0.7690) (attached to:0.0840) (behind:0.5308) (belonging to:0.0143) (between:0.0000) (carrying:0.8377) (covered in:0.5000) (covering:0.3857) (eating:0.8571) (flying in:0.0000) (for:0.2593) (from:0.0000) (growing on:0.0667) (hanging from:0.2831) (has:0.7132) (holding:0.4863) (in:0.3668) (in front of:0.4053) (laying on:0.1905) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3156) (of:0.6191) (on:0.6016) (on back of:0.0455) (over:0.2439) (painted on:0.0000) (parked on:0.9088) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4253) (standing on:0.3620) (to:0.4167) (under:0.3690) (using:0.3077) (walking in:0.0000) (walking on:0.8951) (watching:0.5882) (wearing:0.9553) (wears:0.0239) (with:0.2261) 
SGG eval:   A @ 20: 0.6118;   A @ 50: 0.6161;   A @ 100: 0.6161;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
3
.9
2
.6
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 22:32:54,732 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 22:32:54,732 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.9
    VAL_ALPHA_20: 0.6
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 22:32:54,733 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 22:32:59,297 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
2020-09-13 22:33:03,700 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 22:33:03,701 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 22:33:03,703 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 22:33:03,703 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
2020-09-13 22:33:05,795 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 22:33:06,785 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:33:06,786 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:33:07,329 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 22:33:08,239 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:33:08,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:33:08,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:33:08,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:33:08,240 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:33:08,339 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:33:08,339 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:33:08,339 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:33:08,340 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:33:08,854 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 22:33:09,750 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:33:09,750 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:33:09,750 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:33:09,750 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:33:09,750 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:33:09,846 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:09,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:33:09,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:33:09,847 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:33:09,847 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:33:09,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:33:09,847 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:33:10,222 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 22:33:11,159 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:33:11,159 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:33:11,159 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:33:11,159 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:33:11,159 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:33:11,256 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:33:11,256 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:33:11,256 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:33:11,257 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:33:13,266 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:45:11,656 maskrcnn_benchmark.inference INFO: Total run time: 0:11:58.388802 (0.28735552082061766 s / img per device, on 2 devices)
2020-09-13 22:45:11,656 maskrcnn_benchmark.inference INFO: Model inference time: 0:09:31.929760 (0.2287719041824341 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.55s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=34.39s).
Accumulating evaluation results...
DONE (t=4.89s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 22:47:18,096 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5057;   R @ 50: 0.5589;   R @ 100: 0.5745;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6505; ngR @ 50: 0.8001; ngR @ 100: 0.8772;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0178;  zR @ 50: 0.0378;  zR @ 100: 0.0556;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2624;  mR @ 50: 0.3028;  mR @ 100: 0.3191;  for mode=predcls, type=Mean Recall.
(above:0.2330) (across:0.0556) (against:0.0000) (along:0.4615) (and:0.2043) (at:0.7791) (attached to:0.0840) (behind:0.5129) (belonging to:0.0143) (between:0.0000) (carrying:0.8114) (covered in:0.5000) (covering:0.3857) (eating:0.8571) (flying in:0.0000) (for:0.2593) (from:0.0000) (growing on:0.0667) (hanging from:0.2684) (has:0.6998) (holding:0.5017) (in:0.3703) (in front of:0.3945) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3288) (of:0.5980) (on:0.6055) (on back of:0.0455) (over:0.2439) (painted on:0.0000) (parked on:0.8735) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4192) (standing on:0.3620) (to:0.4167) (under:0.3529) (using:0.3077) (walking in:0.0000) (walking on:0.8934) (watching:0.5882) (wearing:0.9402) (wears:0.0283) (with:0.2319) 
SGG eval:   A @ 20: 0.6124;   A @ 50: 0.6169;   A @ 100: 0.6169;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
1
.3
3
.9
3
.9
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 22:47:24,662 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 22:47:24,662 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.3
    VAL_ALPHA_15: 0.9
    VAL_ALPHA_20: 0.9
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 22:47:24,663 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 22:47:28,045 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
loading word vectors from ./datasets/vg/glove.6B.200d.pt
2020-09-13 22:47:31,908 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 22:47:31,909 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 22:47:31,909 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 22:47:31,909 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
__background__ -> __background__ 
fail on __background__
2020-09-13 22:47:33,460 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:47:34,354 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:47:34,683 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 22:47:35,535 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:47:35,535 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:47:35,535 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:47:35,535 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:47:35,535 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:35,617 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:35,618 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:47:35,618 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:47:35,618 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:47:35,618 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:47:35,618 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:47:35,618 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:47:35,963 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 22:47:36,713 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:47:36,713 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:47:36,716 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:47:36,716 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:47:36,716 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:47:36,806 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:47:37,176 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 22:47:37,933 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:47:37,934 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:47:37,934 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:47:37,934 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:47:37,934 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
flag_stat:  False
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:47:38,026 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:47:38,027 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:47:39,627 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
2020-09-13 22:53:55,934 maskrcnn_benchmark.inference INFO: Total run time: 0:06:16.306530 (0.15052261180877685 s / img per device, on 2 devices)
2020-09-13 22:53:55,934 maskrcnn_benchmark.inference INFO: Model inference time: 0:05:39.896918 (0.1359587671279907 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.55s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=33.77s).
Accumulating evaluation results...
DONE (t=4.99s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 22:56:54,664 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5043;   R @ 50: 0.5582;   R @ 100: 0.5740;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6493; ngR @ 50: 0.7987; ngR @ 100: 0.8765;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0133;  zR @ 50: 0.0333;  zR @ 100: 0.0511;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2626;  mR @ 50: 0.3036;  mR @ 100: 0.3207;  for mode=predcls, type=Mean Recall.
(above:0.2645) (across:0.0556) (against:0.0000) (along:0.4615) (and:0.2204) (at:0.7751) (attached to:0.0932) (behind:0.4966) (belonging to:0.0143) (between:0.0000) (carrying:0.7982) (covered in:0.5714) (covering:0.3857) (eating:0.8571) (flying in:0.0000) (for:0.2778) (from:0.0000) (growing on:0.0667) (hanging from:0.2537) (has:0.6867) (holding:0.5290) (in:0.3707) (in front of:0.3915) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3381) (of:0.5695) (on:0.6097) (on back of:0.0455) (over:0.2439) (painted on:0.0000) (parked on:0.8577) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4218) (standing on:0.3728) (to:0.4167) (under:0.3427) (using:0.3077) (walking in:0.0000) (walking on:0.8877) (watching:0.5882) (wearing:0.9249) (wears:0.0412) (with:0.2374) 
SGG eval:   A @ 20: 0.6128;   A @ 50: 0.6171;   A @ 100: 0.6171;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
2
.6
1
.3
1
.3
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 22:57:13,860 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 22:57:13,861 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.6
    VAL_ALPHA_15: 0.3
    VAL_ALPHA_20: 0.3
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 22:57:13,863 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2020-09-13 22:57:18,381 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
2020-09-13 22:57:22,698 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 22:57:22,699 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 22:57:22,700 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 22:57:22,700 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
2020-09-13 22:57:25,139 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 22:57:26,144 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:57:26,144 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:57:26,144 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:57:26,144 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:57:26,144 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:57:26,144 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:57:26,145 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:57:26,656 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 22:57:27,523 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:57:27,524 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:57:27,524 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:57:27,524 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:57:27,524 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:27,612 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:27,613 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:57:27,613 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:57:27,613 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:57:27,613 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:57:27,613 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:57:27,613 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:57:27,963 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 22:57:28,719 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:57:28,719 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:57:28,719 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:57:28,719 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:57:28,719 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:57:28,801 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:57:28,801 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 22:57:28,802 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 22:57:29,149 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 22:57:29,963 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 22:57:29,963 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 22:57:29,963 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 22:57:29,963 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 22:57:29,963 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 22:57:30,059 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 22:57:31,857 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 23:05:55,322 maskrcnn_benchmark.inference INFO: Total run time: 0:08:23.464696 (0.20138587827682494 s / img per device, on 2 devices)
2020-09-13 23:05:55,323 maskrcnn_benchmark.inference INFO: Model inference time: 0:07:03.794888 (0.16951795511245726 s / img per device, on 2 devices)
creating index...
index created!
Loading and preparing results...
Converting ndarray to lists...
(62754, 7)
0/62754
DONE (t=0.56s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=60.23s).
Accumulating evaluation results...
DONE (t=24.57s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.675
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.994
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 1.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 1.000
2020-09-13 23:09:25,173 maskrcnn_benchmark.inference INFO: 
====================================================================================================
Detection evaluation mAp=0.9999
====================================================================================================
SGG eval:   R @ 20: 0.5486;   R @ 50: 0.6021;   R @ 100: 0.6182;  for mode=predcls, type=Recall(Main).
SGG eval: ngR @ 20: 0.6756; ngR @ 50: 0.8127; ngR @ 100: 0.8846;  for mode=predcls, type=No Graph Constraint Recall(Main).
SGG eval:  zR @ 20: 0.0133;  zR @ 50: 0.0333;  zR @ 100: 0.0511;  for mode=predcls, type=Zero Shot Recall.
SGG eval:  mR @ 20: 0.2476;  mR @ 50: 0.2859;  mR @ 100: 0.3019;  for mode=predcls, type=Mean Recall.
(above:0.1757) (across:0.0556) (against:0.0000) (along:0.3846) (and:0.0645) (at:0.7135) (attached to:0.0289) (behind:0.5077) (belonging to:0.0000) (between:0.0000) (carrying:0.7785) (covered in:0.4524) (covering:0.2673) (eating:0.8571) (flying in:0.0000) (for:0.1944) (from:0.0000) (growing on:0.0667) (hanging from:0.2169) (has:0.7397) (holding:0.5267) (in:0.3697) (in front of:0.4013) (laying on:0.1429) (looking at:0.1957) (lying on:0.0000) (made of:0.0000) (mounted on:0.0000) (near:0.3616) (of:0.5787) (on:0.6980) (on back of:0.0455) (over:0.2195) (painted on:0.0000) (parked on:0.7463) (part of:0.0000) (playing:0.0000) (riding:0.9196) (says:0.0000) (sitting on:0.4379) (standing on:0.3000) (to:0.3611) (under:0.3648) (using:0.3077) (walking in:0.0000) (walking on:0.9012) (watching:0.5294) (wearing:0.9716) (wears:0.0088) (with:0.2014) 
SGG eval:   A @ 20: 0.6493;   A @ 50: 0.6536;   A @ 100: 0.6536;  for mode=predcls, type=TopK Accuracy.
====================================================================================================

VAL_ALPHA
2
.6
1
.3
2
.6
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2020-09-13 23:09:55,086 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 23:09:55,086 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.6
    VAL_ALPHA_15: 0.3
    VAL_ALPHA_20: 0.6
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 23:09:55,088 maskrcnn_benchmark INFO: Collecting env info (might take some time)
VAL_ALPHA
2
.6
1
.3
3
.9
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
loading word vectors from ./datasets/vg/glove.6B.200d.pt
2020-09-13 23:10:13,636 maskrcnn_benchmark INFO: Using 2 GPUs
2020-09-13 23:10:13,637 maskrcnn_benchmark INFO: AMP_VERBOSE: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  TEST: ('VG_stanford_filtered_with_attribute_test',)
  TRAIN: ('VG_stanford_filtered_with_attribute_train',)
  VAL: ('VG_stanford_filtered_with_attribute_val',)
DTYPE: float32
GLOVE_DIR: ./datasets/vg/
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [102.9801, 115.9465, 122.7717]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-101-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FLIP_AUG: False
  FPN:
    USE_GN: False
    USE_RELU: False
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: GeneralizedRCNN
  PRETRAINED_DETECTOR_CKPT: ./checkpoints/pretrained_faster_rcnn/model_final.pth
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 32
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: False
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 8
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTRIBUTE_BGFG_RATIO: 3
    ATTRIBUTE_BGFG_SAMPLE: True
    ATTRIBUTE_LOSS_WEIGHT: 1.0
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MAX_ATTRIBUTES: 10
    NUM_ATTRIBUTES: 201
    POS_WEIGHT: 50.0
    PREDICTOR: FPNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_BINARY_LOSS: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    MLP_HEAD_DIM: 4096
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.3
    DETECTIONS_PER_IMG: 80
    FG_IOU_THRESHOLD: 0.5
    NMS: 0.3
    NMS_FILTER_DUPLICATES: True
    POSITIVE_FRACTION: 0.5
    POST_NMS_PER_CLS_TOPN: 300
    SCORE_THRESH: 0.01
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ADD_GTBOX_TO_PROPOSAL_IN_TRAIN: True
    BATCH_SIZE_PER_IMAGE: 1024
    CAUSAL:
      CONTEXT_LAYER: transformer
      EFFECT_ANALYSIS: True
      EFFECT_TYPE: none
      FUSION_TYPE: sum
      SEPARATE_SPATIAL: False
      SPATIAL_FOR_VISION: True
    CONTEXT_DROPOUT_RATE: 0.2
    CONTEXT_HIDDEN_DIM: 768
    CONTEXT_OBJ_LAYER: 1
    CONTEXT_POOLING_DIM: 4096
    CONTEXT_REL_LAYER: 1
    EMBED_DIM: 200
    FEATURE_EXTRACTOR: RelationFeatureExtractor
    LABEL_SMOOTHING_LOSS: False
    NUM_CLASSES: 51
    NUM_SAMPLE_PER_GT_REL: 4
    POOLING_ALL_LEVELS: True
    POSITIVE_FRACTION: 0.25
    PREDICTOR: TransformerSuperPredictor
    PREDICT_USE_BIAS: True
    PREDICT_USE_VISION: True
    REL_PROP: [0.01858, 0.00057, 0.00051, 0.00109, 0.0015, 0.00489, 0.00432, 0.02913, 0.00245, 0.00121, 0.00404, 0.0011, 0.00132, 0.00172, 5e-05, 0.00242, 0.0005, 0.00048, 0.00208, 0.15608, 0.0265, 0.06091, 0.009, 0.00183, 0.00225, 0.0009, 0.00028, 0.00077, 0.04844, 0.08645, 0.31621, 0.00088, 0.00301, 0.00042, 0.00186, 0.001, 0.00027, 0.01012, 0.0001, 0.01286, 0.00647, 0.00084, 0.01077, 0.00132, 0.00069, 0.00376, 0.00214, 0.11424, 0.01205, 0.02958]
    REQUIRE_BOX_OVERLAP: False
    TRANSFORMER:
      DROPOUT_RATE: 0.1
      INNER_DIM: 2048
      KEY_DIM: 64
      NUM_HEAD: 8
      OBJ_LAYER: 4
      REL_LAYER: 2
      VAL_DIM: 64
    USE_GT_BOX: True
    USE_GT_OBJECT_LABEL: True
    VAL_ALPHA: 1.0
    VAL_ALPHA_10: 0.6
    VAL_ALPHA_15: 0.3
    VAL_ALPHA_20: 0.9
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.23232838, 0.63365731, 1.28478321, 3.15089189)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FPN_POST_NMS_PER_BATCH: False
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 1000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 1000
    PRE_NMS_TOP_N_TEST: 6000
    PRE_NMS_TOP_N_TRAIN: 6000
    RPN_HEAD: SingleConvRPNHead
    RPN_MID_CHANNEL: 256
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  VGG:
    VGG16_OUT_CHANNELS: 512
  WEIGHT: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
OUTPUT_DIR: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16
PATHS_CATALOG: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/paths_catalog.py
PATHS_DATA: /home/guoyuyu/code/scene_graph_gen/scene_graph_benchmark_pytorch/maskrcnn_benchmark/config/../data/datasets
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1
  CHECKPOINT_PERIOD: 2000
  CLIP_NORM: 5.0
  GAMMA: 0.1
  GRAD_NORM_CLIP: 5.0
  IMS_PER_BATCH: 16
  MAX_ITER: 16000
  MOMENTUM: 0.9
  PRE_VAL: True
  PRINT_GRAD_FREQ: 4000
  SCHEDULE:
    COOLDOWN: 0
    FACTOR: 0.1
    MAX_DECAY_STEP: 3
    PATIENCE: 2
    THRESHOLD: 0.001
    TYPE: WarmupMultiStepLR
  STEPS: (10000, 16000)
  TO_VAL: True
  UPDATE_SCHEDULE_DURING_LOAD: False
  VAL_PERIOD: 2000
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0
TEST:
  ALLOW_LOAD_FROM_CACHE: False
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  IMS_PER_BATCH: 2
  RELATION:
    IOU_THRESHOLD: 0.5
    LATER_NMS_PREDICTION_THRES: 0.5
    MULTIPLE_PREDS: False
    REQUIRE_OVERLAP: False
    SYNC_GATHER: True
  SAVE_PROPOSALS: False
  VAL_FLAG: True
2020-09-13 23:10:13,637 maskrcnn_benchmark INFO: Collecting env info (might take some time)
__background__ -> __background__ 
fail on __background__
2020-09-13 23:10:17,024 maskrcnn_benchmark INFO: 
PyTorch version: 1.2.0
Is debug build: No
CUDA used to build PyTorch: 10.0.130

OS: Ubuntu 20.04.1 LTS
GCC version: (Ubuntu 9.3.0-10ubuntu2) 9.3.0
CMake version: version 3.11.3

Python version: 3.7
Is CUDA available: Yes
CUDA runtime version: Could not collect
GPU models and configuration: 
GPU 0: TITAN Xp
GPU 1: TITAN Xp
GPU 2: TITAN Xp
GPU 3: TITAN X (Pascal)
GPU 4: TITAN Xp
GPU 5: TITAN Xp
GPU 6: TITAN Xp
GPU 7: TITAN Xp

Nvidia driver version: 450.51.05
cuDNN version: Probably one of the following:
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_adv_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_cnn_train.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_infer.so.8.0.1
/usr/local/cuda-11.0/targets/x86_64-linux/lib/libcudnn_ops_train.so.8.0.1

Versions of relevant libraries:
[pip3] numpy==1.18.1
[pip3] torch==1.2.0
[pip3] torchvision==0.4.0a0
[conda] _pytorch_select           0.2                       gpu_0  
[conda] blas                      1.0                         mkl    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl                       2020.1                      217    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl-service               2.3.0            py37he904b0f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_fft                   1.0.15           py37ha843d7b_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] mkl_random                1.1.1            py37h0573a6f_0    https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
[conda] pytorch                   1.2.0           cuda100py37h938c94c_0  
[conda] torchvision               0.4.0           cuda100py37hecfc37a_0
        Pillow (7.1.2)
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 23:10:21,414 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
2020-09-13 23:10:21,415 maskrcnn_benchmark.data.build INFO: get dataset statistics...
2020-09-13 23:10:21,416 maskrcnn_benchmark.data.build INFO: Loading data statistics from: ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/VG_stanford_filtered_with_attribute_train_statistics.cache
2020-09-13 23:10:21,416 maskrcnn_benchmark.data.build INFO: ----------------------------------------------------------------------------------------------------
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
loading word vectors from ./datasets/vg/glove.6B.200d.pt
__background__ -> __background__ 
fail on __background__
2020-09-13 23:10:24,485 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from ./checkpoints/transformer_predcls_dist15_2k_IniPModel_CleanHead_Lr1e3_B16/model_0004000.pth
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 23:10:25,640 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 23:10:25,641 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 23:10:25,641 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 23:10:25,641 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 23:10:25,641 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 23:10:26,189 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist10_2k_FixPModel_CleanH_Lr1e3_B16/model_0014000.pth
2020-09-13 23:10:27,061 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 23:10:27,061 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_10.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 23:10:27,061 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 23:10:27,061 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 23:10:27,062 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_10.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_10.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 23:10:27,165 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 23:10:27,548 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist15_2k_FixPModel_CleanH_Lr1e3_B16/model_0004000.pth
2020-09-13 23:10:28,454 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 23:10:28,454 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_15.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 23:10:28,454 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 23:10:28,454 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 23:10:28,454 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_15.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.bias of shape (51,)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_20.weight of shape (51, 1536)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:28,563 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 23:10:28,564 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 23:10:28,564 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 23:10:28,564 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_15.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
2020-09-13 23:10:28,564 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.bias of shape (51,)
2020-09-13 23:10:28,564 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_20.weight of shape (51, 4096)
2020-09-13 23:10:28,974 maskrcnn_benchmark.utils.checkpoint INFO: Loading checkpoint from checkpoints/transformer_predcls_dist20_2k_FixPModel_CleanH_Lr1e3_B16/model_0010000.pth
2020-09-13 23:10:29,946 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.bias in current model to roi_heads.relation.predictor.ctx_compress_clean.bias in loaded model.
2020-09-13 23:10:29,946 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.ctx_compress_clean_20.weight in current model to roi_heads.relation.predictor.ctx_compress_clean.weight in loaded model.
2020-09-13 23:10:29,946 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight in current model to roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight in loaded model.
2020-09-13 23:10:29,946 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.bias in current model to roi_heads.relation.predictor.rel_compress_clean.bias in loaded model.
2020-09-13 23:10:29,947 maskrcnn_benchmark.utils.model_serialization INFO: MAPPING roi_heads.relation.predictor.rel_compress_clean_20.weight in current model to roi_heads.relation.predictor.rel_compress_clean.weight in loaded model.
2020-09-13 23:10:30,045 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.bias of shape (51,)
2020-09-13 23:10:30,045 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_10.weight of shape (51, 1536)
2020-09-13 23:10:30,045 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.bias of shape (51,)
2020-09-13 23:10:30,045 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.ctx_compress_clean_15.weight of shape (51, 1536)
2020-09-13 23:10:30,045 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.ctx_compress_clean.bias                                             of shape (51,)
2020-09-13 23:10:30,045 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.ctx_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.ctx_compress_clean.weight                                           of shape (51, 1536)
2020-09-13 23:10:30,045 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_10.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.freq_bias_clean_15.obj_baseline.weight of shape (22801, 51)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.freq_bias_clean_20.obj_baseline.weight                              loaded from roi_heads.relation.predictor.freq_bias_clean.obj_baseline.weight                                 of shape (22801, 51)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.bias of shape (51,)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_10.weight of shape (51, 4096)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.bias of shape (51,)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: NO-MATCHING of current module: roi_heads.relation.predictor.rel_compress_clean_15.weight of shape (51, 4096)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.bias                                          loaded from roi_heads.relation.predictor.rel_compress_clean.bias                                             of shape (51,)
2020-09-13 23:10:30,046 maskrcnn_benchmark.utils.model_serialization INFO: REMATCHING! roi_heads.relation.predictor.rel_compress_clean_20.weight                                        loaded from roi_heads.relation.predictor.rel_compress_clean.weight                                           of shape (51, 4096)
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
2020-09-13 23:10:32,097 maskrcnn_benchmark.inference INFO: Start evaluation on VG_stanford_filtered_with_attribute_test dataset(5000 images).
flag_stat:  False
root_classes_count:  {}
mean root class number:  0.0
sum root class number:  0
leaf_classes_count:  {}
mean leaf class number:  0.0
sum leaf class number:  0
all_classes_count:  {}
mean all class number:  0.0
sum all class number:  0
number images:  5000
